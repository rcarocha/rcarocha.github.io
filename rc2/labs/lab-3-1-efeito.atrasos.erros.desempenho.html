<p><!DOCTYPE html>
<html>
<title>Redes de Computadores 2 - Prof. Ricardo da Rocha</title></p>

<p><xmp theme="simplex" style="display:none;"></p>

<h1>Laboratório: Efeito de Atrasos e Erros no Desempenho da Camada de Transporte</h1>

<h1>Objetivos</h1>

<ul>
<li>Relembrar o funcionamento de UDP e TCP por experimentações práticas.</li>
<li>Compreender como os atrasos e erros na comunicação influenciam o funcionamento dos protocolos TCP e UDP.</li>
</ul>

<h1>Visão Geral</h1>

<p>Nesta tarefa, você terá que realizar experimentos para analisar o desempenho da comunicação de aplicações que utilizam o TCP e o UDP, em função de variações no atraso e erros na comunicação pela rede. Os atrasos e erros serão emulados no mininet.</p>

<h1>Recursos</h1>

<ul>
<li><p><a href="DESEMP-TCPUDP-apresentacao.pdf">Slides utilizados no laboratório</a></p></li>
<li><p>Máquina Virtual utilizada nos experimentos, inclui o sistema <code>mininet</code> (ver em <a href="https://github.com/mininet/mininet/wiki/Mininet-VM-Images">mininet.org</a>).</p></li>
</ul>

<h2>Softwares</h2>

<ul>
<li><p><strong><code>iperf</code></strong></p>

<ul>
<li><a href="https://iperf.fr/iperf-doc.php">https://iperf.fr/iperf-doc.php</a></li>
<li><a href="http://iperf.sourceforge.net/">http://iperf.sourceforge.net/</a></li>
<li><a href="http://pt.wikipedia.org/wiki/Iperf">http://pt.wikipedia.org/wiki/Iperf</a></li>
<li><a href="http://labcisco.blogspot.com.br/2013/04/iperf-no-monitoramento-de-desempenho-em.html">http://labcisco.blogspot.com.br/2013/04/iperf-no-monitoramento-de-desempenho-em.html</a></li>
</ul></li>
<li><p><strong><code>netem</code></strong>: emulador de rede WAN - utilizaremos a emulação diretamente no mininet (netem será usado indiretamente)</p>

<ul>
<li><a href="http://www.linuxfoundation.org/collaborate/workgroups/networking/netem">http://www.linuxfoundation.org/collaborate/workgroups/networking/netem</a></li>
<li><a href="http://opensourceforu.efytimes.com/2012/06/bandwidth-throttling-netem-network-emulation/">http://opensourceforu.efytimes.com/2012/06/bandwidth-throttling-netem-network-emulation/</a></li>
<li><a href="https://omf.mytestbed.net/projects/omf/wiki/NetEM_examples_of_rules">https://omf.mytestbed.net/projects/omf/wiki/NetEM_examples_of_rules</a></li>
<li><a href="http://www.cs.unm.edu/~crandall/netsfall13/TCtutorial.pdf">http://www.cs.unm.edu/~crandall/netsfall13/TCtutorial.pdf</a></li>
<li><a href="http://linux.die.net/man/8/tc">http://linux.die.net/man/8/tc</a></li>
<li><a href="http://man7.org/linux/man-pages/man8/tc-netem.8.html">http://man7.org/linux/man-pages/man8/tc-netem.8.html</a></li>
<li>ver artigos no fim desta página</li>
</ul></li>
</ul>

<!--
* **`netcat`**
   + <http://linux.die.net/man/1/nc>
   + Inúmeros tutoriais na rede. Exemplo: <https://www.digitalocean.com/community/tutorials/how-to-use-netcat-to-establish-and-test-tcp-and-udp-connections-on-a-vps>

* **`ethtool`**: mostra a configuração da interface de rede disponível na estação.
   + usar o comando `sudo ethtool eth0` para avaliar a configuração da interface cabeada `eth0`.
-->

<h1>Tarefas</h1>

<ol>
<li>Usando o mininet configurado para um cenário mínimo de duas máquinas (com redes virtualizadas).</li>
<li><p>Execute o <code>iperf</code> e meça o desempenho de uma conexão TCP em termos de largura de banda (bandwidth) nas seguintes situações:</p>

<ol>
<li>Transmissão normal, sem limitação de velocidade no mininet.</li>
<li>Transmissão entre as duas estações com a largura de banda entre as estações em 30 Mbps.</li>
</ol></li>
<li><p>Varie a taxa de erros dos enlaces com valores entre 1 e 15%. Escolha ao menos 5 valores nessa faixa. Meça com o iperf o desempenho do TCP, para cada um desses valores. Armazene os valores em um arquivo <code>.csv</code>, com os pares de valores separados por ";". A primeira linha deve conter o nome do dado mantido naquela coluna e a unidade usada. Exemplo: </p>

<pre><code>Taxa erros (%);Largura de Banda (Mbps)
1;30
5;30
...
</code></pre></li>
<li><p>Em um cenário sem erros, varie o atraso entre os enlaces entre 0 e 750 ms, escolhendo ao menos 10 valores nessa faixa. Meça com o iperf o desempenho do TCP, para cada um desses valores. Armazene o resultado do experimento no mesmo formato do item anterior.</p></li>
</ol>

<h3>Configuração de Largura de Banda, Erros e Perda de Pacotes</h3>

<p>Para configurar os parâmetros de largura de banda</p>

<ul>
<li><strong>bw</strong>: largura de banda em Mbps</li>
<li><strong>delay</strong>: atraso na unidade indicada ("5ms" são 5 ms de atraso)</li>
<li><strong>loss</strong>: perda percentual de pacotes no enlace</li>
</ul>

<p>Exemplo:</p>

<pre><code>    sudo mn --link tc,bw=100,delay=5ms,loss=1
</code></pre>

<h1>Relatório</h1>

<p>A entrega do relatório deve ser pelo github classroom, com o qual vocês terão uma área indicada a partir de email enviado para vocês. Esse relatório deve ser entregue em até 5 dias.</p>

<p>Todos os arquivos colocados no github devem estar codificados em <code>UTF-8</code> e devem ser arquivos de texto, seguindo a seguinte estrutura</p>

<pre><code>    README.md       - deve conter uma linha com o seu nome
    Lab3.1.3.csv    - arquivo .csv resposta do item (3)
    Lab3.1.3.png    - gráfico gerado a partir das medições do item (3)
    Lab3.1.3.txt    - explicação e discussão sobre o resultado do item (3)
    Lab3.1.4.csv    - arquivo .csv resposta do item (4)
    Lab3.1.4.png    - gráfico gerado a partir das medições do item (4)
    Lab3.1.4.txt    - explicação e discussão sobre o resultado do item (4)
</code></pre>

<!--
# Parâmetros de Teste

Há vários parâmetros que podem ser utilizados nos testes com TCP e UDP que tem impacto direto no resultado coletado. Não serei rígido com relação ao uso desses parâmetros, mas é importante que vocês verifiquem o efeito da utilização deles.

## iperf 

### TCP

Para obter resultados mais fiéis, é interessante alterar os seguintes parâmetros:

+ **Tempo de teste**: ajustado com o parâmetro `-t`, indicando o tempo em segundos. Por exemplo, `-t 30` indica que o teste deve continuar durante 30s.
+ **Janela de Transmissão/Recepção**: é o tamanho do buffer utilizado pelo TCP durante a transmissão, que permite ao protocolo enviar mais bytes sem receber confirmação do destinatário. O tamanho da janela é ajustado com o parâmetro `-w`, seguido o tamanho em bytes da janela (`1M` significa `1Mbyte`, e `1k` 1Kbytes). Sugiro utilizar `250k` e testar o efeito do aumento ou diminuição.
+ **Teste dual**: o `iperf` realiza por default o teste unidirecional, informando a velocidade em um único sentido. No acesso residencial, como você sabe, a velocidade de transmissão (upstream) é diferente da de recepção (downstream). O `iperf` é capaz de testar a velocidade nos dois sentidos, utilizando o parâmetro `-d`.

Em <http://support.acd.net/wiki/index.php?title=Iperf_Speed_Testing> é sugerido o uso dos seguintes parâmetros para o teste de velocidade (depois de vários experimentos internos):

        iperf -c iperf.acd.net -P 10 -t 240 -w 130000 

O que indica o uso de 10 threads paralelos de comunicação durante 240 segundos (4 minutos), e com uma janela TCP de 127K.

### UDP

Enquanto que a velocidade de transmissão de bytes pelo TCP é ajustada pelos pares que estão se comunicando, isso não ocorre com UDP, quando é possível transmitir em qualquer velocidade até a largura de banda do canal. Por outro lado, o aumento excessivo da velocidade de transmissão pode fazer com que haja mais pacotes perdidos e até influenciar no jitter obtido.

O `iperf` utiliza como default uma taxa de transmissão de 1Mbps, o que é usualmente uma velocidade baixa em relação ao que se pode transmitir. Para ajustar essa velicidade, deve-se utilizar o parâmetro **`-b`** seguido da velocidade de transmissão desejada. Para realizar um teste com o servidor `192.168.7.7` com transmissão na velocidade 20Mbps deve-se utilizar a seguinte linha de comando:

        iperf -u -c 192.168.7.7 -b 20M

O `iperf` entende `M`, `K` e `G` como Mbps, Kbps e Gbps, respectivamente. Nos seus testes, é adequado aumentar a largura de banda utilizada e observar os efeitos no resultado obtido, que segue o seguinte formato: `<largura efetiva> <jitter> <pacotes perdidos/recebidos>`.
-->

<!--
## Emulador de Atrasos e Erros netem

+ Taxa de transmissão: (**inicie testando unicamente este parâmetro**)
   + Taxas e atrasos comuns em diversas redes: <https://en.wikipedia.org/wiki/Bandwidth-delay_product#Examples>
+ Atrasos: 1, 10, 20 e 100ms.
+ Distribuição de atrasos: normal
+ Perda de pacotes: 0.1%, 1%, 10%, 50% e 90%.
+ Duplicação de pacotes: *livre escolha do aluno*
+ Corrupção de pacotes: *livre escolha do aluno*
+ Reordenação de pacotes: *livre escolha do aluno*
-->

<h1>Referências</h1>

<!--
+ **`netem`**
   + Hemminger, Stephen. ["Network emulation with NetEm."](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.67.1687&rep=rep1&type=pdf) Linux conf au. 2005.
   + Jurgelionis, Audrius, et al. ["An empirical study of netem network emulation functionalities."](http://www.idi.ntnu.no/~alfw/publications/icccn2011-netem.pdf) Computer Communications and Networks (ICCCN), 2011 Proceedings of 20th International Conference on. IEEE, 2011.
-->

<ul>
<li><strong><code>iperf</code></strong>
<ul>
<li>Bom tutorial para uso do <code>iperf</code>: <a href="http://trilug.org/~bfarrow/talks/iperf-Bill-Farrow-2013.pdf">http://trilug.org/~bfarrow/talks/iperf-Bill-Farrow-2013.pdf</a></li>
</ul></li>
<li>Discussão geral de ferramentas de teste de desempenho
<ul>
<li><a href="http://kb.pert.geant.net/twiki/bin/view/PERTKB/IperfTool">http://kb.pert.geant.net/twiki/bin/view/PERTKB/IperfTool</a></li>
</ul></li>
</ul>

<p></xmp></p>

<script src="https://strapdownjs.com/v/0.2/strapdown.js"></script>

<p></html></p>
