<p><!DOCTYPE html>
<html>
<title>Redes de Computadores 2 - Prof. Ricardo da Rocha</title></p>

<p><xmp theme="simplex" style="display:none;"></p>

<h1>LaboratÃÂÃÂ³rio: Protocolo ARP e InspeÃÂÃÂ§ÃÂÃÂ£o em Pacotes IP e Ethernet</h1>

<!--
rede com estaÃÂÃÂ§ÃÂÃÂµes e roteador.
ARP
- verificar tabela
- --mac
- forÃÂÃÂ§ar estaÃÂÃÂ§ÃÂÃÂ£o a aparecer no ARP. confirmar.

    arp -n

- verificar tempo de vida das entradas no ARP e entradas sumindo. (default 60s)
- estaÃÂÃÂ§ÃÂÃÂµes em redes diferentes o ARP nÃÂÃÂ£o aparece.
InspeÃÂÃÂ§ÃÂÃÂ£o de pacotes
- geral no funcionamento
- interceptaÃÂÃÂ§ÃÂÃÂ£o e interpretaÃÂÃÂ§ÃÂÃÂ£o dos pacotes

1. Escolha uma das estaÃÂÃÂ§ÃÂÃÂµes do experimento realizado e use o **wireshark** para capturar os pacotes daquela estaÃÂÃÂ§ÃÂÃÂ£o. Para isso, **dentro do mininet**:

   1. Inicie um terminal executando naquela estaÃÂÃÂ§ÃÂÃÂ£o, por exemplo:

        xterm h1

   2. Inicie o wireshark (`sudo wireshark &`). Se o procedimento foi realizado corretamente, o wireshark mostrarÃÂÃÂ¡ apenas as interfaces de rede da estaÃÂÃÂ§ÃÂÃÂ£o com rede virtual que vocÃÂÃÂª selecionou, como `h1-eth0`.
   3. Capture a interface ethernet (exemplo: `h1-eth0`) daquela estaÃÂÃÂ§ÃÂÃÂ£o.

2. Repita as etapas anteriores de uso do ARP, verificando os pacotes ARP que sÃÂÃÂ£o enviados e recebidos pela estaÃÂÃÂ§ÃÂÃÂ£o. 
3. Copie os dados dos pacotes recebidos e enviados, usando a funÃÂÃÂ§ÃÂÃÂ£o **"Copy"**->**"Summary (CSV)"** do wireshark (clique no pacote capturado com o botÃÂÃÂ£o da direita).
4. Force o envio de um pacote da sua estaÃÂÃÂ§ÃÂÃÂ£o da uma estaÃÂÃÂ§ÃÂÃÂ£o na outra rede (por exemplo, use um `ping`). Verifique no pacote enviado e na resposta recebida, os endereÃÂÃÂ§os IPs e MAC de origem e destino. Copie dois desses pacotes.



- troca de pacotes do ARP - saindo e chegando.
    endereÃÂÃÂ§os dos pacotes que saem
    endereÃÂÃÂ§o de broadcast
-->

<h1>Objetivos</h1>

<ul>
<li>Aprender a inspecionar pacotes via Wireshark no mininet</li>
<li>ReforÃÂÃÂ§ar o conhecimento do funcionamento da camada de rede e enlace</li>
<li>Verificar o efeito dos algoritmos dos protocolos IP e IEE 802.3 nas modificaÃÂÃÂ§ÃÂÃÂµes de seus pacotes.</li>
<li>Verificar, na prÃÂÃÂ¡tica, o modelo de camadas funcionando</li>
</ul>

<h1>VisÃÂÃÂ£o Geral</h1>

<p>Neste laboratÃÂÃÂ³rio vocÃÂÃÂª irÃÂÃÂ¡ inspecionar pacotes IP e Ethernet para identificar o efeito do roteamento nos pacotes da camada de rede e de enlace. </p>

<h1>Recursos</h1>

<ul>
<li><p>MÃÂÃÂ¡quina Virtual utilizada nos experimentos, inclui o sistema <code>mininet</code> (ver em <a href="https://github.com/mininet/mininet/wiki/Mininet-VM-Images">mininet.org</a>).</p>

<ul>
<li>A VM ficarÃÂÃÂ¡ disponÃÂÃÂ­vel no laboratÃÂÃÂ³rio em um servidor web na mÃÂÃÂ¡quina pessoal do professor no endereÃÂÃÂ§o IP indicado em sala, porta 8888 e caminho <strong><code>vmlab.zip</code></strong>. VocÃÂÃÂª poderÃÂÃÂ¡ baixar usando o comando <strong><code>wget http://ip.maq.professor:8888/vmlab.zip</code></strong>. A VM ÃÂÃÂ© um Ubuntu 14.04 - 64 bit (com Mininet 2.2.1).</li>
<li>Espere que o professor coloque a distribuiÃÂÃÂ§ÃÂÃÂ£o da mÃÂÃÂ¡quina no ar.</li>
</ul></li>
<li><p>Na VM com mininet, tanto o login como a senha sÃÂÃÂ£o <code>mininet</code>.</p></li>
</ul>

<h2>Ambiente grÃÂÃÂ¡fico na VM Mininet</h2>

<p>Neste laboratÃÂÃÂ³rio, precisaremos utilizar o programa <strong>wireshark</strong> na VM do mininet que possui interface grÃÂÃÂ¡fica. Para isso, ÃÂÃÂ© necessÃÂÃÂ¡rio configurar o ambiente (estaÃÂÃÂ§ÃÂÃÂ£o hospedeira) conforme indicado do primeiro laboratÃÂÃÂ³rio mininet.</p>

<p>Outra opÃÂÃÂ§ÃÂÃÂ£o ÃÂÃÂ© instalar um ambiente grÃÂÃÂ¡fico da VM mininet, seguindo as instruÃÂÃÂ§ÃÂÃÂµes indicadas em <a href="https://github.com/mininet/mininet/wiki/FAQ#vm-console-gui">https://github.com/mininet/mininet/wiki/FAQ#vm-console-gui</a>. Para isto basta instalar o pacote (sugerido) com o comando abaixo (<em>poderÃÂÃÂ¡ demorar</em>):</p>

<pre><code>    sudo apt-get install xinit lxde
</code></pre>

<p>O ambiente grÃÂÃÂ¡fico ÃÂÃÂ© iniciado com o comando <code>startx</code>.</p>

<h1>Atividades</h1>

<ol>
<li>Execute o mininet com o exemplo <code>~/mininet/examples/linuxrouter.py</code>, do laboratÃÂÃÂ³rio <em>"Roteamento EstÃÂÃÂ¡tico com mininet"</em>, que possui duas redes e um roteador.</li>
<li><p>Verifique o estado das tabelas ARP nas estaÃÂÃÂ§ÃÂÃÂµes, utilizando o comando:</p>

<pre><code>arp -n
</code></pre></li>
<li><p>Force a atualizaÃÂÃÂ§ÃÂÃÂ£o das tabelas ARP por meio do envio de mensagens entre as estaÃÂÃÂ§ÃÂÃÂµes. Sugiro efetue um ping entre <code>h1</code> e <code>h2</code> do exemplo (na verdade, qualquer par de estaÃÂÃÂ§ÃÂÃÂµes, excetuando o roteador <code>r0</code>). Para realizar o seu teste, sugiro utilizar o parÃÂÃÂ¢metro <strong><code>-c 1</code></strong> no ping, com o qual ele envia apenas uma mensagem. Assim, serÃÂÃÂ¡ mais fÃÂÃÂ¡cil correlacionar requisiÃÂÃÂ§ÃÂÃÂ£o e resposta produzidos pelo ping.</p></li>
<li>Verifique novamente o estado das tabelas ARP, lembrando de fazÃÂÃÂª-lo com estaÃÂÃÂ§ÃÂÃÂµes em redes diferentes.</li>
<li><p><em>Antes desta etapa o professor realizarÃÂÃÂ¡ uma demonstraÃÂÃÂ§ÃÂÃÂ£o de uso do wireshark</em>. Escolha uma das estaÃÂÃÂ§ÃÂÃÂµes do experimento realizado e use o <strong>wireshark</strong> para capturar os pacotes daquela estaÃÂÃÂ§ÃÂÃÂ£o. Para isso, <strong>dentro do mininet</strong>:</p>

<ol>
<li><p>Inicie um terminal executando naquela estaÃÂÃÂ§ÃÂÃÂ£o, por exemplo:</p>

<p>xterm h1</p></li>
<li><p>Inicie o wireshark (<code>sudo wireshark &amp;</code>). Se o procedimento foi realizado corretamente, o wireshark mostrarÃÂÃÂ¡ apenas as interfaces de rede da estaÃÂÃÂ§ÃÂÃÂ£o com rede virtual que vocÃÂÃÂª selecionou, como <code>h1-eth0</code>.</p></li>
<li>Capture a interface ethernet (exemplo: <code>h1-eth0</code>) daquela estaÃÂÃÂ§ÃÂÃÂ£o.</li>
</ol></li>
<li><p>Repita as etapas anteriores de uso do ARP (de <strong>1</strong> a <strong>4</strong>), verificando os pacotes ARP que sÃÂÃÂ£o enviados e recebidos pela estaÃÂÃÂ§ÃÂÃÂ£o. </p></li>
<li>Copie os dados dos pacotes recebidos e enviados, usando a funÃÂÃÂ§ÃÂÃÂ£o <strong>"Copy"</strong>-><strong>"Summary (CSV)"</strong> do wireshark (clique no pacote capturado com o botÃÂÃÂ£o da direita).</li>
<li>Force o envio de um pacote da sua estaÃÂÃÂ§ÃÂÃÂ£o da uma estaÃÂÃÂ§ÃÂÃÂ£o na outra rede (por exemplo, use um <code>ping</code>). Verifique no pacote enviado e na resposta recebida, os endereÃÂÃÂ§os IPs e MAC de origem e destino. Copie dois desses pacotes.</li>
</ol>

<h1>RelatÃÂÃÂ³rio</h1>

<p>A entrega do relatÃÂÃÂ³rio deve ser pelo github classroom, com o qual vocÃÂÃÂªs terÃÂÃÂ£o uma ÃÂÃÂ¡rea indicada a partir de email enviado para vocÃÂÃÂªs. Esse relatÃÂÃÂ³rio deve ser entregue em atÃÂÃÂ© 8 dias.</p>

<p>Todos os arquivos colocados no github devem estar codificados em <code>UTF-8</code> e devem ser arquivos de texto, seguindo a seguinte estrutura</p>

<pre><code>    README.md       - deve conter uma linha com o seu nome
    Lab1.4.2.txt    - tabela produzida no item (2)
    Lab1.4.4.txt    - tabela produzida no item (4)
    Lab1.4.6.3.txt  - resposta do item (6), apÃÂÃÂ³s repetir os itens de (2) a (4) e copiar o conteÃÂÃÂºdo dos pacotes ARP enviados e recebidos.
    Lab1.4.8.txt    - resposta do item (8), e copiar o conteÃÂÃÂºdo dos pacotes ICMP (do `ping`) enviados e recebidos.
</code></pre>

<p></xmp></p>

<script src="https://strapdownjs.com/v/0.2/strapdown.js"></script>

<p></html></p>

<!--
#################################
aprender a inspecionar pacotes via Wireshark
montar a rede da aula anterior
- revisÃÂÃÂ£o de pacotes IP
- revisÃÂÃÂ£o de pacotes Ethernet
rever funcionamento do ARP
inspecionar os pacotes recebidos e transmitidos pelo roteador

questÃÂÃÂµes:
- quais modificaÃÂÃÂ§ÃÂÃÂµes ocorrem no pacote IP transmitido de A para B
- explique as razÃÂÃÂµes de tais modificaÃÂÃÂ§ÃÂÃÂµes
- quais modificaÃÂÃÂ§ÃÂÃÂµes ocorrem no pacote Ethernet (Enlace) transmitido de A para B (chegando e saindo do roteador)
- explique as razÃÂÃÂµes de tais modificaÃÂÃÂ§ÃÂÃÂµes
-->
