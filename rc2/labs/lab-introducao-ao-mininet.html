<p><!DOCTYPE html>
<html>
<title>Redes de Computadores 2 - Prof. Ricardo da Rocha</title></p>

<p><xmp theme="simplex" style="display:none;"></p>

<h1>LaboratÃÂÃÂ³rio: IntroduÃÂÃÂ§ÃÂÃÂ£o ao <strong><code>mininet</code></strong> com avaliaÃÂÃÂ§ÃÂÃÂ£o TCP e UDP</h1>

<h1>Objetivos</h1>

<ul>
<li>Introduzir a ferramenta de emulaÃÂÃÂ§ÃÂÃÂ£o de redes <code>mininet</code> de maneira a tornar os alunos aptos a realizarem os prÃÂÃÂ³ximos laboratÃÂÃÂ³rios da disciplina.</li>
<li>Compreender a arquitetura de funcionamento do <code>mininet</code>.</li>
</ul>

<h1>PrÃÂÃÂ©-requisitos</h1>

<p>Se vocÃÂÃÂª for realizar os experimento na sua prÃÂÃÂ³pria mÃÂÃÂ¡quina, vocÃÂÃÂª deve ter o Virtual Box instalado, ou outro ambiente para execuÃÂÃÂ§ÃÂÃÂ£o de mÃÂÃÂ¡quina virtual.</p>

<h1>VisÃÂÃÂ£o Geral</h1>

<p>Neste laboratÃÂÃÂ³rio, nÃÂÃÂ³s iremos aprender o propÃÂÃÂ³sito e funcionamento bÃÂÃÂ¡sico da ferramenta <code>mininet</code> que seja a principal ferramenta para os demais laboratÃÂÃÂ³rios da disciplina. Essas tarefas sÃÂÃÂ£o baseadas no tutorial do mininet descrito em <a href="http://mininet.org/walkthrough/">http://mininet.org/walkthrough/</a>.</p>

<h1>Recursos</h1>

<ul>
<li><p><a href="pdf/mininet-intro.pdf">Slides utilizados no laboratÃÂÃÂ³rio</a></p></li>
<li><p>MÃÂÃÂ¡quina Virtual utilizada nos experimentos, inclui o sistema <code>mininet</code> (ver em <a href="https://github.com/mininet/mininet/wiki/Mininet-VM-Images">mininet.org</a>).</p>

<ul>
<li>A VM ficarÃÂÃÂ¡ disponÃÂÃÂ­vel no laboratÃÂÃÂ³rio em um servidor web na mÃÂÃÂ¡quina pessoal do professor no endereÃÂÃÂ§o IP indicado em sala, porta 8888 e caminho <strong><code>vmlab.zip</code></strong>. VocÃÂÃÂª poderÃÂÃÂ¡ baixar usando o comando <strong><code>wget http://ip.maq.professor:8888/vmlab.zip</code></strong>. A VM ÃÂÃÂ© um Ubuntu 14.04 - 64 bit (com Mininet 2.2.1).</li>
</ul></li>
<li><p>Na VM com mininet, tanto o login como a senha sÃÂÃÂ£o <code>mininet</code>.</p></li>
</ul>

<h1>Tarefas</h1>

<p>As tarefas de 1 a 7 referenciam os comandos abaixo, identificados pelo seu nÃÂÃÂºmero. Quando iniciado com prefixo <code>$</code>, um comando indica que estÃÂÃÂ¡ sendo executado no prompt do Linux (VM), enquanto que se iniciado com <code>mininet &gt;</code>, o comando estÃÂÃÂ¡ sendo executado no ambiente mininet.</p>

<pre><code>$ sudo mn                            #1
mininet&gt; nodes                       #2
mininet&gt; net                         #3
mininet&gt; h1 ifconfig -a              #4
mininet&gt; h1 ping -c 1 h2             #5
mininet&gt; pingall                     #6
mininet&gt; iperf                       #7
$ sudo mn --topo single,3            #8
$ sudo mn --topo linear,4            #9
$ sudo mn --link tc,bw=100,delay=5ms #10
$ iperf -c 10.0.0.2                  #11
$ iperf -s                           #12
mininet&gt; xterm h1 h2                 #13
</code></pre>

<ol>
<li>Instale a VM com o mininet na sua estaÃÂÃÂ§ÃÂÃÂ£o, inicialize a mÃÂÃÂ¡quina e entre no sistema.</li>
<li>Inicie o mininet com a topologia padrÃÂÃÂ£o (#1). Verifique os nÃÂÃÂ³s e a conectividade entre eles (2,3).</li>
<li>Utilize o comando <code>ifconfig</code> para identificar a configuraÃÂÃÂ§ÃÂÃÂ£o da rede de cada nÃÂÃÂ³-estaÃÂÃÂ§ÃÂÃÂ£o (4).</li>
<li>Teste a conectividade entre os nÃÂÃÂ³s utilizando <code>ping</code> (5) e <code>pingall</code> (6).</li>
<li>Teste o desempenho da comunicaÃÂÃÂ§ÃÂÃÂ£o TCP e UDP entre os nÃÂÃÂ³s usando <code>iperf</code>  e <code>iperfudp</code> (7).</li>
<li>RefaÃÂÃÂ§a os testes acima configurando uma topologia de comunicaÃÂÃÂ§ÃÂÃÂ£o <strong>single</strong> com 3 nÃÂÃÂ³s (8), e <strong>linear</strong> com 4 nÃÂÃÂ³s (9).</li>
<li>RefaÃÂÃÂ§a os testes de desempenho de comunicaÃÂÃÂ§ÃÂÃÂ£o TCP, UDP e ping, usando uma configuraÃÂÃÂ§ÃÂÃÂ£o de nÃÂÃÂ³s com largura de banda 100Mbps e atraso de 5ms (10). MeÃÂÃÂ§a os atrasos entre os nÃÂÃÂ³s e a taxa de transferÃÂÃÂªncia.</li>
<li>RefaÃÂÃÂ§a os testes de desempenho anteriores, invocando o comando <code>iperf</code> em um terminal (<code>xterm</code>) individual em cada nÃÂÃÂ³/estaÃÂÃÂ§ÃÂÃÂ£o. Uma estaÃÂÃÂ§ÃÂÃÂ£o deverÃÂÃÂ¡ ser um servidor <code>iperf</code> (12) e outra o cliente (11). Para abrir um terminal para cada nÃÂÃÂ³ vocÃÂÃÂª deverÃÂÃÂ¡ usar o comando <code>xterm</code> (13), e vocÃÂÃÂª deverÃÂÃÂ¡ configurar o seu ambiente Virtual Box, mininet e estaÃÂÃÂ§ÃÂÃÂ£o host, conforme explicado na seÃÂÃÂ§ÃÂÃÂ£o <a href="#execucao-do-wireshark-e-terminal-remoto">"ExecuÃÂÃÂ§ÃÂÃÂ£o do wireshark e terminal remoto"</a>.</li>
</ol>

<h2>SubmissÃÂÃÂ£o do laboratÃÂÃÂ³rio</h2>

<p>VocÃÂÃÂª deverÃÂÃÂ¡ submeter um arquivo <code>Lab1.2-7.txt</code> (arquivo de texto) contendo o resultado dos testes realizados na tarefa (7). <strong>Observe que</strong> para facilitar a obtenÃÂÃÂ§ÃÂÃÂ£o dos resultados, vocÃÂÃÂª deverÃÂÃÂ¡ acessar o mininet por terminais remotos (exibidos no seu ambiente host).</p>

<!--
Caso vocÃÂÃÂª tenha problemas no uso do teclado com o mininet (caracteres mostrados nÃÂÃÂ£o correspondem aos do teclado), seja a seÃÂÃÂ§ÃÂÃÂ£o [*"ConfiguraÃÂÃÂ§ÃÂÃÂ£o do teclado"*](#configuracao-teclado) abaixo.
-->

<p><a id="execucao-do-wireshark-e-terminal-remoto"></a></p>

<h2>ExecuÃÂÃÂ§ÃÂÃÂ£o do wireshark e terminal remoto</h2>

<p>Na execuÃÂÃÂ§ÃÂÃÂ£o do wireshark (ou do terminal <code>xterm</code>), provavelmente vocÃÂÃÂª se depararÃÂÃÂ¡ com o erro da figura abaixo.</p>

<p><img src="img/mininet-X11-error.png" /></p>

<p>Esse problema ocorre porque o wireshark pretende exportar (exibir) a sua interface grÃÂÃÂ¡fica (X11) na estaÃÂÃÂ§ÃÂÃÂ£o anfitriÃÂÃÂ£ que abriga a VM em execuÃÂÃÂ§ÃÂÃÂ£o, ao invÃÂÃÂ©s na mÃÂÃÂ¡quina virtualizada (que nÃÂÃÂ£o contÃÂÃÂ©m suporte a GUI). O sistema X11, utilizado em muitos  sistemas operacionais baseados em Unix, permite que um programa exiba a sua interface em outra estaÃÂÃÂ§ÃÂÃÂ£o, oferecendo para tal um protocolo prÃÂÃÂ³prio de rede. A comunicaÃÂÃÂ§ÃÂÃÂ£o entre a VM e a estaÃÂÃÂ§ÃÂÃÂ£o serÃÂÃÂ¡ intermediada pelo SSH que ÃÂÃÂ© um serviÃÂÃÂ§o de terminal remoto que utiliza criptografia. Para que isso seja possÃÂÃÂ­vel ÃÂÃÂ© necessÃÂÃÂ¡rio atender aos seguintes prÃÂÃÂ©-requisitos:</p>

<ol>
<li>VM precisa executar um servidor SSH, que serÃÂÃÂ¡ contactado pelo estaÃÂÃÂ§ÃÂÃÂ£o. 
<ul>
<li>Na VM mininet isso jÃÂÃÂ¡ ÃÂÃÂ© garantido por padrÃÂÃÂ£o.</li>
</ul></li>
<li>A estaÃÂÃÂ§ÃÂÃÂ£o anfitriÃÂÃÂ£ precisa dispor de um cliente SSH para contactar o servidor na VM. 
<ul>
<li>Em qualquer distribuiÃÂÃÂ§ÃÂÃÂ£o Linux isso jÃÂÃÂ¡ ÃÂÃÂ© satisfeito. Em estaÃÂÃÂ§ÃÂÃÂµes Windows, vocÃÂÃÂª precisarÃÂÃÂ¡ realizar uma instalaÃÂÃÂ§ÃÂÃÂ£o adicional (nÃÂÃÂ£o coberta nesse laboratÃÂÃÂ³rio).</li>
</ul></li>
<li>A estaÃÂÃÂ§ÃÂÃÂ£o anfitriÃÂÃÂ£ precisa dispor de um servidor X11. 
<ul>
<li>Em qualquer distribuiÃÂÃÂ§ÃÂÃÂ£o Linux com interface grÃÂÃÂ¡fica isso jÃÂÃÂ¡ ÃÂÃÂ© satisfeito. Em estaÃÂÃÂ§ÃÂÃÂµes Windows, vocÃÂÃÂª precisarÃÂÃÂ¡ realizar uma instalaÃÂÃÂ§ÃÂÃÂ£o adicional (nÃÂÃÂ£o coberta nesse laboratÃÂÃÂ³rio), sendo sugerido o uso do cygwin/x (<a href="http://www.cygwin.com/">http://www.cygwin.com/</a> e <a href="http://x.cygwin.com/">http://x.cygwin.com/</a>).</li>
</ul></li>
<li>No seu player de mÃÂÃÂ¡quina virtual, vamos usar VirtualBox, precisarÃÂÃÂ¡ configurar a rede da VM para permitir acessibilidade externa a serviÃÂÃÂ§os locais (escutando por uma porta) e para isso precisaremos fazer um <em>port forwarding</em>.
<ul>
<li>Na configuraÃÂÃÂ§ÃÂÃÂ£o de <strong>network</strong> da VM, clique em <em>"Port forwarding"</em> (veja figura).</li>
</ul></li>
</ol>

<p><img src="img/mininet-portf.png" /></p>

<ul>
<li>Crie uma regra de encaminhamento de portas adequado. No exemplo da figura, escolhi o encaminhamento da porta da estaÃÂÃÂ§ÃÂÃÂ£o anfitriÃÂÃÂ£ 2222 para a porta 22 da VM, que ÃÂÃÂ© a porta onde o servidor SSH da VM estarÃÂÃÂ¡ esperando conexÃÂÃÂµes. A porta 2222 ÃÂÃÂ© um exemplo e outra porta pode ser escolhida, mas <strong>necessariamente</strong> a mesma porta deverÃÂÃÂ¡ ser usada no comando do item seguinte.</li>
</ul>

<p><img src="img/mininet-portf-2.png" /></p>

<ul>
<li><p>Para  estabelecer a conexÃÂÃÂ£o SSH com o servidor, serÃÂÃÂ¡ necessÃÂÃÂ¡rio executar o seguinte comando</p>

<pre><code>ssh -X mininet@127.0.0.1 -p 2222
</code></pre></li>
<li><p>Agora, vocÃÂÃÂª conseguirÃÂÃÂ¡ executar o wireshark no mininet, exibindo a sua interface na sua estaÃÂÃÂ§ÃÂÃÂ£o (anfitriÃÂÃÂ£), executando (no terminal criado anteriormente):</p>

<pre><code>sudo wireshark &amp;
</code></pre></li>
</ul>

<p>Para iniciar o wireshark no ambiente de um dos hosts virtualizados, vocÃÂÃÂª deve abrir um terminal naquele respectivo host, via mininet. Por exemplo, para abrir um terminal para o host <code>h1</code>, use o seguinte comando de dentro do mininet:</p>

<pre><code>    xterm h1
</code></pre>

<p>DocumentaÃÂÃÂ§ÃÂÃÂ£o detalhada sobre esse problema e sua soluÃÂÃÂ§ÃÂÃÂ£o pode ser encontrada em <a href="https://github.com/mininet/mininet/wiki/FAQ#x11-forwarding">https://github.com/mininet/mininet/wiki/FAQ#x11-forwarding</a>.</p>

<h3>Problemas comuns</h3>

<ul>
<li>Se algumas teclas nÃÂÃÂ£o estÃÂÃÂ£o funcionando corretamente (exemplo: <code>/</code>), reconfigure o teclado utilizando o comando <code>sudo dpkg-reconfigure keyboard-configuration</code>.</li>
</ul>

<h1>ReferÃÂÃÂªncias</h1>

<ul>
<li><code>mininet</code>: <a href="http://mininet.org/">http://mininet.org/</a>
<ul>
<li>DocumentaÃÂÃÂ§ÃÂÃÂ£o 
<ul>
<li><a href="https://github.com/mininet/mininet/wiki/Introduction-to-Mininet">IntroduÃÂÃÂ§ÃÂÃÂ£o ao Mininet</a></li>
<li>DemonstraÃÂÃÂ§ÃÂÃÂ£o de comandos mininet: <a href="http://mininet.org/walkthrough/">http://mininet.org/walkthrough/</a></li>
<li>Comandos (interface nÃÂÃÂ£o programada): <a href="http://mininet.org/walkthrough/#part-3-mininet-command-line-interface-cli-commands">http://mininet.org/walkthrough/#part-3-mininet-command-line-interface-cli-commands</a></li>
<li>Iniciando com o Mininet (incluindo download): <a href="http://mininet.org/download/">http://mininet.org/download/</a></li>
<li>Encaminhamento da interface grÃÂÃÂ¡fica das aplicaÃÂÃÂ§ÃÂÃÂµes na VM (forwarding X11): <a href="https://github.com/mininet/mininet/wiki/FAQ#x11-forwarding">https://github.com/mininet/mininet/wiki/FAQ#x11-forwarding</a></li>
</ul></li>
</ul></li>
<li><code>traceroute</code> (no Windows <code>tracert</code>): o capÃÂÃÂ­tulo 1 do livro do Kurose oferece uma explicaÃÂÃÂ§ÃÂÃÂ£o sobre a ferramenta.</li>
<li><code>iperf</code>
<ul>
<li><a href="http://iperf.sourceforge.net/">http://iperf.sourceforge.net/</a></li>
<li><a href="http://pt.wikipedia.org/wiki/Iperf">http://pt.wikipedia.org/wiki/Iperf</a></li>
<li><a href="http://labcisco.blogspot.com.br/2013/04/iperf-no-monitoramento-de-desempenho-em.html">http://labcisco.blogspot.com.br/2013/04/iperf-no-monitoramento-de-desempenho-em.html</a></li>
</ul></li>
<li><code>httperf</code>
<ul>
<li>Mosberger, David, and Tai Jin. <a href="http://www.hpl.hp.com/research/linux/httperf/wisp98/httperf.pdf">"httperf - a tool for measuring web server performance."</a> ACM SIGMETRICS Performance Evaluation Review 26.3 (1998): 31-37.</li>
<li><a href="http://www.comlore.com/httperf.html">http://www.comlore.com/httperf.html</a></li>
<li><a href="http://mervine.net/performance-testing-with-httperf">http://mervine.net/performance-testing-with-httperf</a></li>
</ul></li>
<li>DiscussÃÂÃÂ£o geral de ferramentas de teste de desempenho
<ul>
<li><a href="http://kb.pert.geant.net/twiki/bin/view/PERTKB/IperfTool">http://kb.pert.geant.net/twiki/bin/view/PERTKB/IperfTool</a></li>
</ul></li>
<li><code>sudo apt-get install x11-xkb-utils</code></li>
</ul>

<p></xmp></p>

<script src="https://strapdownjs.com/v/0.2/strapdown.js"></script>

<p></html></p>
