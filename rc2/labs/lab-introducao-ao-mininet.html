<p><!DOCTYPE html>
<html>
<title>Redes de Computadores 2 - Prof. Ricardo da Rocha</title></p>

<p><xmp theme="simplex" style="display:none;"></p>

<h1>LaboratÃ³rio: IntroduÃ§Ã£o ao <strong><code>mininet</code></strong> com avaliaÃ§Ã£o TCP e UDP</h1>

<h1>Objetivos</h1>

<ul>
<li>Introduzir a ferramenta de emulaÃ§Ã£o de redes <code>mininet</code> de maneira a tornar os alunos aptos a realizarem os prÃ³ximos laboratÃ³rios da disciplina.</li>
<li>Compreender a arquitetura de funcionamento do <code>mininet</code>.</li>
</ul>

<h1>PrÃ©-requisitos</h1>

<p>Se vocÃª for realizar os experimento na sua prÃ³pria mÃ¡quina, vocÃª deve ter o Virtual Box instalado, ou outro ambiente para execuÃ§Ã£o de mÃ¡quina virtual.</p>

<h1>VisÃ£o Geral</h1>

<p>Neste laboratÃ³rio, nÃ³s iremos aprender o propÃ³sito e funcionamento bÃ¡sico da ferramenta <code>mininet</code> que seja a principal ferramenta para os demais laboratÃ³rios da disciplina. Essas tarefas sÃ£o baseadas no tutorial do mininet descrito em <a href="http://mininet.org/walkthrough/">http://mininet.org/walkthrough/</a>.</p>

<h1>Recursos</h1>

<ul>
<li><p><a href="pdf/mininet-intro.pdf">Slides utilizados no laboratÃ³rio</a></p></li>
<li><p>MÃ¡quina Virtual utilizada nos experimentos, inclui o sistema <code>mininet</code> (ver em <a href="https://github.com/mininet/mininet/wiki/Mininet-VM-Images">mininet.org</a>).</p>

<ul>
<li>A VM ficarÃ¡ disponÃ­vel no laboratÃ³rio em um servidor web na mÃ¡quina pessoal do professor no endereÃ§o IP indicado em sala, porta 8888 e caminho <strong><code>vmlab.zip</code></strong>. VocÃª poderÃ¡ baixar usando o comando <strong><code>wget http://ip.maq.professor:8888/vmlab.zip</code></strong>. A VM Ã© um Ubuntu 14.04 - 64 bit (com Mininet 2.2.1).</li>
</ul></li>
<li><p>Na VM com mininet, tanto o login como a senha sÃ£o <code>mininet</code>.</p></li>
</ul>

<h1>Tarefas</h1>

<p>As tarefas de 1 a 7 referenciam os comandos abaixo, identificados pelo seu nÃºmero. Quando iniciado com prefixo <code>$</code>, um comando indica que estÃ¡ sendo executado no prompt do Linux (VM), enquanto que se iniciado com <code>mininet &gt;</code>, o comando estÃ¡ sendo executado no ambiente mininet.</p>

<pre><code>$ sudo mn                            #1
mininet&gt; nodes                       #2
mininet&gt; net                         #3
mininet&gt; h1 ifconfig -a              #4
mininet&gt; h1 ping -c 1 h2             #5
mininet&gt; pingall                     #6
mininet&gt; iperf                       #7
$ sudo mn --topo single,3            #8
$ sudo mn --topo linear,4            #9
$ sudo mn --link tc,bw=100,delay=5ms #10
$ iperf -c 10.0.0.2                  #11
$ iperf -s                           #12
mininet&gt; xterm h1 h2                 #13
</code></pre>

<ol>
<li>Instale a VM com o mininet na sua estaÃ§Ã£o, inicialize a mÃ¡quina e entre no sistema.</li>
<li>Inicie o mininet com a topologia padrÃ£o (#1). Verifique os nÃ³s e a conectividade entre eles (2,3).</li>
<li>Utilize o comando <code>ifconfig</code> para identificar a configuraÃ§Ã£o da rede de cada nÃ³-estaÃ§Ã£o (4).</li>
<li>Teste a conectividade entre os nÃ³s utilizando <code>ping</code> (5) e <code>pingall</code> (6).</li>
<li>Teste o desempenho da comunicaÃ§Ã£o TCP e UDP entre os nÃ³s usando <code>iperf</code>  e <code>iperfudp</code> (7).</li>
<li>RefaÃ§a os testes acima configurando uma topologia de comunicaÃ§Ã£o <strong>single</strong> com 3 nÃ³s (8), e <strong>linear</strong> com 4 nÃ³s (9).</li>
<li>RefaÃ§a os testes de desempenho de comunicaÃ§Ã£o TCP, UDP e ping, usando uma configuraÃ§Ã£o de nÃ³s com largura de banda 100Mbps e atraso de 5ms (10). MeÃ§a os atrasos entre os nÃ³s e a taxa de transferÃªncia.</li>
<li>RefaÃ§a os testes de desempenho anteriores, invocando o comando <code>iperf</code> em um terminal (<code>xterm</code>) individual em cada nÃ³/estaÃ§Ã£o. Uma estaÃ§Ã£o deverÃ¡ ser um servidor <code>iperf</code> (12) e outra o cliente (11). Para abrir um terminal para cada nÃ³ vocÃª deverÃ¡ usar o comando <code>xterm</code> (13), e vocÃª deverÃ¡ configurar o seu ambiente Virtual Box, mininet e estaÃ§Ã£o host, conforme explicado na seÃ§Ã£o <a href="#execucao-do-wireshark-e-terminal-remoto">"ExecuÃ§Ã£o do wireshark e terminal remoto"</a>.</li>
</ol>

<h2>SubmissÃ£o do laboratÃ³rio</h2>

<p>VocÃª deverÃ¡ submeter um arquivo <code>Lab1.2-7.txt</code> (arquivo de texto) contendo o resultado dos testes realizados na tarefa (7). <strong>Observe que</strong> para facilitar a obtenÃ§Ã£o dos resultados, vocÃª deverÃ¡ acessar o mininet por terminais remotos (exibidos no seu ambiente host).</p>

<!--
Caso vocÃª tenha problemas no uso do teclado com o mininet (caracteres mostrados nÃ£o correspondem aos do teclado), seja a seÃ§Ã£o [*"ConfiguraÃ§Ã£o do teclado"*](#configuracao-teclado) abaixo.
-->

<p><a id="execucao-do-wireshark-e-terminal-remoto"></a></p>

<h2>ExecuÃ§Ã£o do wireshark e terminal remoto</h2>

<p>Na execuÃ§Ã£o do wireshark (ou do terminal <code>xterm</code>), provavelmente vocÃª se depararÃ¡ com o erro da figura abaixo.</p>

<p><img src="img/mininet-X11-error.png" /></p>

<p>Esse problema ocorre porque o wireshark pretende exportar (exibir) a sua interface grÃ¡fica (X11) na estaÃ§Ã£o anfitriÃ£ que abriga a VM em execuÃ§Ã£o, ao invÃ©s na mÃ¡quina virtualizada (que nÃ£o contÃ©m suporte a GUI). O sistema X11, utilizado em muitos  sistemas operacionais baseados em Unix, permite que um programa exiba a sua interface em outra estaÃ§Ã£o, oferecendo para tal um protocolo prÃ³prio de rede. A comunicaÃ§Ã£o entre a VM e a estaÃ§Ã£o serÃ¡ intermediada pelo SSH que Ã© um serviÃ§o de terminal remoto que utiliza criptografia. Para que isso seja possÃ­vel Ã© necessÃ¡rio atender aos seguintes prÃ©-requisitos:</p>

<ol>
<li>VM precisa executar um servidor SSH, que serÃ¡ contactado pelo estaÃ§Ã£o. 
<ul>
<li>Na VM mininet isso jÃ¡ Ã© garantido por padrÃ£o.</li>
</ul></li>
<li>A estaÃ§Ã£o anfitriÃ£ precisa dispor de um cliente SSH para contactar o servidor na VM. 
<ul>
<li>Em qualquer distribuiÃ§Ã£o Linux isso jÃ¡ Ã© satisfeito. Em estaÃ§Ãµes Windows, vocÃª precisarÃ¡ realizar uma instalaÃ§Ã£o adicional (nÃ£o coberta nesse laboratÃ³rio).</li>
</ul></li>
<li>A estaÃ§Ã£o anfitriÃ£ precisa dispor de um servidor X11. 
<ul>
<li>Em qualquer distribuiÃ§Ã£o Linux com interface grÃ¡fica isso jÃ¡ Ã© satisfeito. Em estaÃ§Ãµes Windows, vocÃª precisarÃ¡ realizar uma instalaÃ§Ã£o adicional (nÃ£o coberta nesse laboratÃ³rio), sendo sugerido o uso do cygwin/x (<a href="http://www.cygwin.com/">http://www.cygwin.com/</a> e <a href="http://x.cygwin.com/">http://x.cygwin.com/</a>).</li>
</ul></li>
<li>No seu player de mÃ¡quina virtual, vamos usar VirtualBox, precisarÃ¡ configurar a rede da VM para permitir acessibilidade externa a serviÃ§os locais (escutando por uma porta) e para isso precisaremos fazer um <em>port forwarding</em>.
<ul>
<li>Na configuraÃ§Ã£o de <strong>network</strong> da VM, clique em <em>"Port forwarding"</em> (veja figura).</li>
</ul></li>
</ol>

<p><img src="img/mininet-portf.png" /></p>

<ul>
<li>Crie uma regra de encaminhamento de portas adequado. No exemplo da figura, escolhi o encaminhamento da porta da estaÃ§Ã£o anfitriÃ£ 2222 para a porta 22 da VM, que Ã© a porta onde o servidor SSH da VM estarÃ¡ esperando conexÃµes. A porta 2222 Ã© um exemplo e outra porta pode ser escolhida, mas <strong>necessariamente</strong> a mesma porta deverÃ¡ ser usada no comando do item seguinte.</li>
</ul>

<p><img src="img/mininet-portf-2.png" /></p>

<ul>
<li><p>Para  estabelecer a conexÃ£o SSH com o servidor, serÃ¡ necessÃ¡rio executar o seguinte comando</p>

<pre><code>ssh -X mininet@127.0.0.1 -p 2222
</code></pre></li>
<li><p>Agora, vocÃª conseguirÃ¡ executar o wireshark no mininet, exibindo a sua interface na sua estaÃ§Ã£o (anfitriÃ£), executando (no terminal criado anteriormente):</p>

<pre><code>sudo wireshark &amp;
</code></pre></li>
</ul>

<p>Para iniciar o wireshark no ambiente de um dos hosts virtualizados, vocÃª deve abrir um terminal naquele respectivo host, via mininet. Por exemplo, para abrir um terminal para o host <code>h1</code>, use o seguinte comando de dentro do mininet:</p>

<pre><code>    xterm h1
</code></pre>

<p>DocumentaÃ§Ã£o detalhada sobre esse problema e sua soluÃ§Ã£o pode ser encontrada em <a href="https://github.com/mininet/mininet/wiki/FAQ#x11-forwarding">https://github.com/mininet/mininet/wiki/FAQ#x11-forwarding</a>.</p>

<h3>Problemas comuns</h3>

<ul>
<li>Se algumas teclas nÃ£o estÃ£o funcionando corretamente (exemplo: <code>/</code>), reconfigure o teclado utilizando o comando <code>sudo dpkg-reconfigure keyboard-configuration</code>.</li>
</ul>

<h1>ReferÃªncias</h1>

<ul>
<li><code>mininet</code>: <a href="http://mininet.org/">http://mininet.org/</a>
<ul>
<li>DocumentaÃ§Ã£o 
<ul>
<li><a href="https://github.com/mininet/mininet/wiki/Introduction-to-Mininet">IntroduÃ§Ã£o ao Mininet</a></li>
<li>DemonstraÃ§Ã£o de comandos mininet: <a href="http://mininet.org/walkthrough/">http://mininet.org/walkthrough/</a></li>
<li>Comandos (interface nÃ£o programada): <a href="http://mininet.org/walkthrough/#part-3-mininet-command-line-interface-cli-commands">http://mininet.org/walkthrough/#part-3-mininet-command-line-interface-cli-commands</a></li>
<li>Iniciando com o Mininet (incluindo download): <a href="http://mininet.org/download/">http://mininet.org/download/</a></li>
<li>Encaminhamento da interface grÃ¡fica das aplicaÃ§Ãµes na VM (forwarding X11): <a href="https://github.com/mininet/mininet/wiki/FAQ#x11-forwarding">https://github.com/mininet/mininet/wiki/FAQ#x11-forwarding</a></li>
</ul></li>
</ul></li>
<li><code>traceroute</code> (no Windows <code>tracert</code>): o capÃ­tulo 1 do livro do Kurose oferece uma explicaÃ§Ã£o sobre a ferramenta.</li>
<li><code>iperf</code>
<ul>
<li><a href="http://iperf.sourceforge.net/">http://iperf.sourceforge.net/</a></li>
<li><a href="http://pt.wikipedia.org/wiki/Iperf">http://pt.wikipedia.org/wiki/Iperf</a></li>
<li><a href="http://labcisco.blogspot.com.br/2013/04/iperf-no-monitoramento-de-desempenho-em.html">http://labcisco.blogspot.com.br/2013/04/iperf-no-monitoramento-de-desempenho-em.html</a></li>
</ul></li>
<li><code>httperf</code>
<ul>
<li>Mosberger, David, and Tai Jin. <a href="http://www.hpl.hp.com/research/linux/httperf/wisp98/httperf.pdf">"httperf - a tool for measuring web server performance."</a> ACM SIGMETRICS Performance Evaluation Review 26.3 (1998): 31-37.</li>
<li><a href="http://www.comlore.com/httperf.html">http://www.comlore.com/httperf.html</a></li>
<li><a href="http://mervine.net/performance-testing-with-httperf">http://mervine.net/performance-testing-with-httperf</a></li>
</ul></li>
<li>DiscussÃ£o geral de ferramentas de teste de desempenho
<ul>
<li><a href="http://kb.pert.geant.net/twiki/bin/view/PERTKB/IperfTool">http://kb.pert.geant.net/twiki/bin/view/PERTKB/IperfTool</a></li>
</ul></li>
<li><code>sudo apt-get install x11-xkb-utils</code></li>
</ul>

<p></xmp></p>

<script src="https://strapdownjs.com/v/0.2/strapdown.js"></script>

<p></html></p>
